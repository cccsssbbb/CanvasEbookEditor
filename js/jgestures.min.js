(function(i){i.jGestures={};i.jGestures.defaults={};i.jGestures.defaults.thresholdShake={requiredShakes:10,freezeShakes:100,frontback:{sensitivity:10},leftright:{sensitivity:10},updown:{sensitivity:10}};i.jGestures.defaults.thresholdPinchopen=0.05;i.jGestures.defaults.thresholdPinchmove=0.05;i.jGestures.defaults.thresholdPinch=0.05;i.jGestures.defaults.thresholdPinchclose=0.05;i.jGestures.defaults.thresholdRotatecw=5;i.jGestures.defaults.thresholdRotateccw=5;i.jGestures.defaults.thresholdMove=20;i.jGestures.defaults.thresholdSwipe=100;i.jGestures.data={};i.jGestures.data.capableDevicesInUserAgentString=["iPad","iPhone","iPod","Mobile Safari"];i.jGestures.data.hasGestures=(function(){var k;for(k=0;k<i.jGestures.data.capableDevicesInUserAgentString.length;k++){if(navigator.userAgent.indexOf(i.jGestures.data.capableDevicesInUserAgentString[k])!==-1){return true}}return false})();i.hasGestures=i.jGestures.data.hasGestures;i.jGestures.events={touchstart:"jGestures.touchstart",touchendStart:"jGestures.touchend;start",touchendProcessed:"jGestures.touchend;processed",gesturestart:"jGestures.gesturestart",gestureendStart:"jGestures.gestureend;start",gestureendProcessed:"jGestures.gestureend;processed"};jQuery.each({orientationchange_orientationchange01:"orientationchange",gestureend_pinchopen01:"pinchopen",gestureend_pinchclose01:"pinchclose",gestureend_rotatecw01:"rotatecw",gestureend_rotateccw01:"rotateccw",gesturechange_pinch01:"pinch",gesturechange_rotate01:"rotate",touchstart_swipe13:"swipemove",touchstart_swipe01:"swipeone",touchstart_swipe02:"swipetwo",touchstart_swipe03:"swipethree",touchstart_swipe04:"swipefour",touchstart_swipe05:"swipeup",touchstart_swipe06:"swiperightup",touchstart_swipe07:"swiperight",touchstart_swipe08:"swiperightdown",touchstart_swipe09:"swipedown",touchstart_swipe10:"swipeleftdown",touchstart_swipe11:"swipeleft",touchstart_swipe12:"swipeleftup",touchstart_tap01:"tapone",touchstart_tap02:"taptwo",touchstart_tap03:"tapthree",touchstart_tap04:"tapfour",devicemotion_shake01:"shake",devicemotion_shake02:"shakefrontback",devicemotion_shake03:"shakeleftright",devicemotion_shake04:"shakeupdown"},function(l,k){jQuery.event.special[k]={setup:function(){var p=l.split("_");var m=p[0];var q=p[1].slice(0,p[1].length-2);var n=jQuery(this);var o;var r;if(!n.data("ojQueryGestures")||!n.data("ojQueryGestures")[m]){o=n.data("ojQueryGestures")||{};r={};r[m]=true;i.extend(true,o,r);n.data("ojQueryGestures",o);if(i.hasGestures){switch(q){case"orientationchange":n.get(0).addEventListener("orientationchange",g,false);break;case"shake":case"shakefrontback":case"shakeleftright":case"shakeupdown":case"tilt":n.get(0).addEventListener("devicemotion",h,false);break;case"tap":case"swipe":case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":n.get(0).addEventListener("touchstart",d,false);break;case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":n.get(0).addEventListener("gesturestart",a,false);n.get(0).addEventListener("gestureend",e,false);break;case"pinch":case"rotate":n.get(0).addEventListener("gesturestart",a,false);n.get(0).addEventListener("gesturechange",b,false);break}}else{switch(q){case"tap":case"swipe":n.bind("mousedown",d);break;case"orientationchange":case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":case"pinch":case"rotate":case"shake":case"tilt":break}}}return false},add:function(o){var n=jQuery(this);var m=n.data("ojQueryGestures");m[o.type]={originalType:o.type};return false},remove:function(o){var n=jQuery(this);var m=n.data("ojQueryGestures");m[o.type]=false;n.data("ojQueryGestures",m);return false},teardown:function(){var p=l.split("_");var m=p[0];var q=p[1].slice(0,p[1].length-2);var n=jQuery(this);var o;var r;if(!n.data("ojQueryGestures")||!n.data("ojQueryGestures")[m]){o=n.data("ojQueryGestures")||{};r={};r[m]=false;i.extend(true,o,r);n.data("ojQueryGestures",o);if(i.hasGestures){switch(q){case"orientationchange":n.get(0).removeEventListener("orientationchange",g,false);break;case"shake":case"shakefrontback":case"shakeleftright":case"shakeupdown":case"tilt":n.get(0).removeEventListener("devicemotion",h,false);break;case"tap":case"swipe":case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":case"swipeleftup":n.get(0).removeEventListener("touchstart",d,false);n.get(0).removeEventListener("touchmove",c,false);n.get(0).removeEventListener("touchend",f,false);break;case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":n.get(0).removeEventListener("gesturestart",a,false);n.get(0).removeEventListener("gestureend",e,false);break;case"pinch":case"rotate":n.get(0).removeEventListener("gesturestart",a,false);n.get(0).removeEventListener("gesturechange",b,false);break}}else{switch(q){case"tap":case"swipe":n.unbind("mousedown",d);n.unbind("mousemove",c);n.unbind("mouseup",f);break;case"orientationchange":case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":case"pinch":case"rotate":case"shake":case"tilt":break}}}return false}}});function j(m){m.startMove=(m.startMove)?m.startMove:{startX:null,startY:null,timestamp:null};var n=new Date().getTime();var k;var l;if(m.touches){l=[{lastX:m.deltaX,lastY:m.deltaY,moved:null,startX:m.screenX-m.startMove.screenX,startY:m.screenY-m.startMove.screenY}];k={vector:m.vector||null,orientation:window.orientation||null,lastX:((l[0].lastX>0)?+1:((l[0].lastX<0)?-1:0)),lastY:((l[0].lastY>0)?+1:((l[0].lastY<0)?-1:0)),startX:((l[0].startX>0)?+1:((l[0].startX<0)?-1:0)),startY:((l[0].startY>0)?+1:((l[0].startY<0)?-1:0))};l[0].moved=Math.sqrt(Math.pow(Math.abs(l[0].startX),2)+Math.pow(Math.abs(l[0].startY),2))}return{type:m.type||null,originalEvent:m.event||null,delta:l||null,direction:k||{orientation:window.orientation||null,vector:m.vector||null},duration:(m.duration)?m.duration:(m.startMove.timestamp)?n-m.timestamp:null,rotation:m.rotation||null,scale:m.scale||null,description:m.description||[m.type,":",m.touches,":",((l[0].lastX!=0)?((l[0].lastX>0)?"right":"left"):"steady"),":",((l[0].lastY!=0)?((l[0].lastY>0)?"down":"up"):"steady")].join("")}}function g(l){var k=["landscape:clockwise:","portrait:default:","landscape:counterclockwise:","portrait:upsidedown:"];i(window).triggerHandler("orientationchange",{direction:{orientation:window.orientation},description:["orientationchange:",k[((window.orientation/90)+1)],window.orientation].join("")})}function h(l){var o;var n=jQuery(window);var s=n.data("ojQueryGestures");var q=i.jGestures.defaults.thresholdShake;var r=s.oDeviceMotionLastDevicePosition||{accelerationIncludingGravity:{x:0,y:0,z:0},shake:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakeleftright:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakefrontback:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakeupdown:{eventCount:0,intervalsPassed:0,intervalsFreeze:0}};var k={accelerationIncludingGravity:{x:l.accelerationIncludingGravity.x,y:l.accelerationIncludingGravity.y,z:l.accelerationIncludingGravity.z},shake:{eventCount:r.shake.eventCount,intervalsPassed:r.shake.intervalsPassed,intervalsFreeze:r.shake.intervalsFreeze},shakeleftright:{eventCount:r.shakeleftright.eventCount,intervalsPassed:r.shakeleftright.intervalsPassed,intervalsFreeze:r.shakeleftright.intervalsFreeze},shakefrontback:{eventCount:r.shakefrontback.eventCount,intervalsPassed:r.shakefrontback.intervalsPassed,intervalsFreeze:r.shakefrontback.intervalsFreeze},shakeupdown:{eventCount:r.shakeupdown.eventCount,intervalsPassed:r.shakeupdown.intervalsPassed,intervalsFreeze:r.shakeupdown.intervalsFreeze}};var t;var m;var p;for(o in s){switch(o){case"shake":case"shakeleftright":case"shakefrontback":case"shakeupdown":t=[];m=[];t.push(o);if(++k[o].intervalsFreeze>q.freezeShakes&&k[o].intervalsFreeze<(2*q.freezeShakes)){break}k[o].intervalsFreeze=0;k[o].intervalsPassed++;if((o==="shake"||o==="shakeleftright")&&(k.accelerationIncludingGravity.x>q.leftright.sensitivity||k.accelerationIncludingGravity.x<(-1*q.leftright.sensitivity))){t.push("leftright");t.push("x-axis")}if((o==="shake"||o==="shakefrontback")&&(k.accelerationIncludingGravity.y>q.frontback.sensitivity||k.accelerationIncludingGravity.y<(-1*q.frontback.sensitivity))){t.push("frontback");t.push("y-axis")}if((o==="shake"||o==="shakeupdown")&&(k.accelerationIncludingGravity.z+9.81>q.updown.sensitivity||k.accelerationIncludingGravity.z+9.81<(-1*q.updown.sensitivity))){t.push("updown");t.push("z-axis")}if(t.length>1){if(++k[o].eventCount==q.requiredShakes&&(k[o].intervalsPassed)<q.freezeShakes){n.triggerHandler(o,j({type:o,description:t.join(":"),event:l,duration:k[o].intervalsPassed*5}));k[o].eventCount=0;k[o].intervalsPassed=0;k[o].intervalsFreeze=q.freezeShakes+1}else{if(k[o].eventCount==q.requiredShakes&&(k[o].intervalsPassed)>q.freezeShakes){k[o].eventCount=0;k[o].intervalsPassed=0}}}break}p={};p.oDeviceMotionLastDevicePosition=k;n.data("ojQueryGestures",i.extend(true,s,p))}}function d(o){var n=jQuery(o.currentTarget);n.triggerHandler(i.jGestures.events.touchstart,o);if(i.hasGestures){o.currentTarget.addEventListener("touchmove",c,false);o.currentTarget.addEventListener("touchend",f,false)}else{n.bind("mousemove",c);n.bind("mouseup",f)}var l=n.data("ojQueryGestures");var k=(o.touches)?o.touches[0]:o;var m={};m.oLastSwipemove={screenX:k.screenX,screenY:k.screenY,timestamp:new Date().getTime()};m.oStartTouch={screenX:k.screenX,screenY:k.screenY,timestamp:new Date().getTime()};n.data("ojQueryGestures",i.extend(true,l,m))}function c(l){var n=jQuery(l.currentTarget);var k=n.data("ojQueryGestures");var u=!!l.touches;var p=(u)?l.changedTouches[0].screenX:l.screenX;var o=(u)?l.changedTouches[0].screenY:l.screenY;var v=k.oLastSwipemove;var s=p-v.screenX;var r=o-v.screenY;var m;if(!!k.oLastSwipemove){m=j({type:"swipemove",touches:(u)?l.touches.length:"1",screenY:o,screenX:p,deltaY:r,deltaX:s,startMove:v,event:l,timestamp:v.timestamp});n.triggerHandler(m.type,m)}var q={};var t=(l.touches)?l.touches[0]:l;q.oLastSwipemove={screenX:t.screenX,screenY:t.screenY,timestamp:new Date().getTime()};n.data("ojQueryGestures",i.extend(true,k,q))}function f(v){var z=jQuery(v.currentTarget);var B=!!v.changedTouches;var y=(B)?v.changedTouches.length:"1";var p=(B)?v.changedTouches[0].screenX:v.screenX;var o=(B)?v.changedTouches[0].screenY:v.screenY;z.triggerHandler(i.jGestures.events.touchendStart,v);if(i.hasGestures){v.currentTarget.removeEventListener("touchmove",c,false);v.currentTarget.removeEventListener("touchend",f,false)}else{z.unbind("mousemove",c);z.unbind("mouseup",f)}var m=z.data("ojQueryGestures");var q=(Math.abs(m.oStartTouch.screenX-p)>i.jGestures.defaults.thresholdMove||Math.abs(m.oStartTouch.screenY-o)>i.jGestures.defaults.thresholdMove)?true:false;var u=(Math.abs(m.oStartTouch.screenX-p)>i.jGestures.defaults.thresholdSwipe||Math.abs(m.oStartTouch.screenY-o)>i.jGestures.defaults.thresholdSwipe)?true:false;var r;var x;var n;var l;var k;var t;var A=["zero","one","two","three","four"];var w;for(r in m){x=m.oStartTouch;n={};p=(B)?v.changedTouches[0].screenX:v.screenX;o=(B)?v.changedTouches[0].screenY:v.screenY;l=p-x.screenX;k=o-x.screenY;t=j({type:"swipe",touches:y,screenY:o,screenX:p,deltaY:k,deltaX:l,startMove:x,event:v,timestamp:x.timestamp});w=false;switch(r){case"swipeone":if(B===false&&y==1&&q===false){break}if(B===false||(y==1&&q===true&&u===true)){w=true;t.type=["swipe",A[y]].join("");z.triggerHandler(t.type,t)}break;case"swipetwo":if((B&&y==2&&q===true&&u===true)){w=true;t.type=["swipe",A[y]].join("");z.triggerHandler(t.type,t)}break;case"swipethree":if((B&&y==3&&q===true&&u===true)){w=true;t.type=["swipe",A[y]].join("");z.triggerHandler(t.type,t)}break;case"swipefour":if((B&&y==4&&q===true&&u===true)){w=true;t.type=["swipe",A[y]].join("");z.triggerHandler(t.type,t)}break;case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":case"swipeleftup":if(B&&q===true&&u===true){w=true;t.type=["swipe",((t.delta[0].lastX!=0)?((t.delta[0].lastX>0)?"right":"left"):""),((t.delta[0].lastY!=0)?((t.delta[0].lastY>0)?"down":"up"):"")].join("");z.triggerHandler(t.type,t)}break;case"tapone":case"taptwo":case"tapthree":case"tapfour":if((q!==true&&w!==true)&&(A[y]==r.slice(3))){t.description=["tap",A[y]].join("");t.type=["tap",A[y]].join("");z.triggerHandler(t.type,t)}break}var s={};z.data("ojQueryGestures",i.extend(true,m,s));z.data("ojQueryGestures",i.extend(true,m,s))}z.triggerHandler(i.jGestures.events.touchendProcessed,v)}function a(n){var m=jQuery(n.currentTarget);m.triggerHandler(i.jGestures.events.gesturestart,n);var k=m.data("ojQueryGestures");var l={};l.oStartTouch={timestamp:new Date().getTime()};m.data("ojQueryGestures",i.extend(true,k,l))}function b(r){var q=jQuery(r.currentTarget);var n,k,p,m;var o=q.data("ojQueryGestures");var l;for(l in o){switch(l){case"pinch":n=r.scale;if(((n<1)&&(n%1)<(1-i.jGestures.defaults.thresholdPinchclose))||((n>1)&&(n%1)>(i.jGestures.defaults.thresholdPinchopen))){k=(n<1)?-1:+1;m=j({type:"pinch",scale:n,touches:null,startMove:o.oStartTouch,event:r,timestamp:o.oStartTouch.timestamp,vector:k,description:["pinch:",k,":",((n<1)?"close":"open")].join("")});q.triggerHandler(m.type,m)}break;case"rotate":n=r.rotation;if(((n<1)&&(-1*(n)>i.jGestures.defaults.thresholdRotateccw))||((n>1)&&(n>i.jGestures.defaults.thresholdRotatecw))){k=(n<1)?-1:+1;m=j({type:"rotate",rotation:n,touches:null,startMove:o.oStartTouch,event:r,timestamp:o.oStartTouch.timestamp,vector:k,description:["rotate:",k,":",((n<1)?"counterclockwise":"clockwise")].join("")});q.triggerHandler(m.type,m)}break}}}function e(o){var n=jQuery(o.currentTarget);n.triggerHandler(i.jGestures.events.gestureendStart,o);var l;var m=n.data("ojQueryGestures");var k;for(k in m){switch(k){case"pinchclose":l=o.scale;if((l<1)&&(l%1)<(1-i.jGestures.defaults.thresholdPinchclose)){n.triggerHandler("pinchclose",j({type:"pinchclose",scale:l,vector:-1,touches:null,startMove:m.oStartTouch,event:o,timestamp:m.oStartTouch.timestamp,description:"pinch:-1:close"}))}break;case"pinchopen":l=o.scale;if((l>1)&&(l%1)>(i.jGestures.defaults.thresholdPinchopen)){n.triggerHandler("pinchopen",j({type:"pinchopen",scale:l,vector:+1,touches:null,startMove:m.oStartTouch,event:o,timestamp:m.oStartTouch.timestamp,description:"pinch:+1:open"}))}break;case"rotatecw":l=o.rotation;if((l>1)&&(l>i.jGestures.defaults.thresholdRotatecw)){n.triggerHandler("rotatecw",j({type:"rotatecw",rotation:l,vector:+1,touches:null,startMove:m.oStartTouch,event:o,timestamp:m.oStartTouch.timestamp,description:"rotate:+1:clockwise"}))}break;case"rotateccw":l=o.rotation;if((l<1)&&(-1*(l)>i.jGestures.defaults.thresholdRotateccw)){n.triggerHandler("rotateccw",j({type:"rotateccw",rotation:l,vector:-1,touches:null,startMove:m.oStartTouch,event:o,timestamp:m.oStartTouch.timestamp,description:"rotate:-1:counterclockwise"}))}break}}n.triggerHandler(i.jGestures.events.gestureendProcessed,o)}})(jQuery);